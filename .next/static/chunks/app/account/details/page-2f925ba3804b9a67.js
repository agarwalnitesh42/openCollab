(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[216],{8382:function(e,t,s){Promise.resolve().then(s.bind(s,69035))},69035:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var a=s(57437),r=s(2265),l=s(26930),n=s(7765),u=e=>{let{avatarUrl:t,avatarPreview:s,setSelectedImage:u=()=>"",setAvatarPreview:c=()=>""}=e,i=(0,r.useRef)(null),o=()=>{var e;null===(e=i.current)||void 0===e||e.click()},d=e=>{if(!e.target.files)return;let t=e.target.files[0];t&&t.type.includes("image")&&(u(t),c(URL.createObjectURL(t)))};return(0,a.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,a.jsx)("label",{htmlFor:"Avatar-upload",className:"cursor-pointer",children:(0,a.jsx)(n.Z,{alt:"user profil",src:s||t})}),(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsx)(l.Z,{onClick:()=>o(),className:" bg-slate-800 hover:bg-slate-800/50 text-xs",children:"Upload new Avatar"}),s?(0,a.jsx)(l.Z,{onClick:()=>{u(null),c("")},className:"text-xs bg-transparent border border-slate-800",children:"cancel"}):""]}),(0,a.jsx)("input",{ref:i,id:"Avatar-upload",name:"file-upload",type:"file",className:"sr-only ",accept:"image/*",onChange:e=>d(e)})]})},c=s(51478),i=s(20257),o=s(94562),d=s(61211),m=s(65928),h=s(84488),f=s(59789),x=function(){let{session:e,user:t}=(0,d.useSupabase)(),s=null==e?void 0:e.user,n=new h.Z((0,m.A)()),x=n.getById(null==s?void 0:s.id),[g,v]=(0,r.useState)(!1),[p,b]=(0,r.useState)(""),[j,w]=(0,r.useState)(""),[y,Z]=(0,r.useState)(""),[N,_]=(0,r.useState)(""),[S,k]=(0,r.useState)(!1),[C,U]=(0,r.useState)(""),[A,E]=(0,r.useState)(""),[P,F]=(0,r.useState)("/user.svg"),[L,q]=(0,r.useState)(null),[R,T]=(0,r.useState)(""),[B,I]=(0,r.useState)(""),[z,O]=(0,r.useState)(""),[D,H]=(0,r.useState)(""),[M,V]=(0,r.useState)(""),[W,$]=(0,r.useState)("");(0,r.useEffect)(()=>{x.then(e=>{F((null==t?void 0:t.avatar_url)||"/user.svg"),b((null==e?void 0:e.full_name)||""),w((null==e?void 0:e.username)||""),U((null==e?void 0:e.about)||""),Z((null==e?void 0:e.website_url)||""),_((null==s?void 0:s.user_metadata.email)||""),E((null==e?void 0:e.headline)||"")})},[]);let G=()=>{if(I(""),H(""),p.length<2&&I("Please enter a correct full name"),j.length<4&&O("the username should at least be 4 chars or more"),!y||/^(https?:\/\/)?([a-z0-9-]+\.)+[a-z]{2,}(\/.*)*$/i.test(y))return!0;H("Please enter a valid URL")},J=async e=>{e.preventDefault(),G()&&(v(!0),L&&await n.updateAvatar(null==s?void 0:s.id,L),n.update(null==s?void 0:s.id,{full_name:p,username:j,about:C,headline:A,website_url:y}).then(()=>{v(!1),R&&F(R),T(""),q(null)}))};return(0,r.useEffect)(()=>{setTimeout(()=>{k(!1)},6e3)},[S]),(0,a.jsxs)("div",{className:"container-custom-screen h-screen mt-20",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl text-black font-semibold",children:"Profile"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-black",children:"This information will be displayed publicly so be careful what you share."})]}),(0,a.jsxs)("div",{className:"mt-14",children:[(0,a.jsx)(u,{avatarUrl:P,avatarPreview:R,setSelectedImage:q,setAvatarPreview:T}),(0,a.jsx)("form",{onSubmit:J,className:"mt-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Z,{children:"Full name"}),(0,a.jsx)(c.Z,{value:p,onChange:e=>{b(e.target.value)},className:"w-full mt-2"}),(0,a.jsx)(f.Z,{className:"mt",children:B})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Z,{children:"Username"}),(0,a.jsx)(c.Z,{value:j,onChange:e=>{w(e.target.value)},className:"w-full mt-2"}),(0,a.jsx)(f.Z,{className:"mt",children:z})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(i.Z,{children:"Email"}),(0,a.jsx)(c.Z,{type:"email",value:N,onClick:()=>k(!0),className:"w-full mt-2",disabled:S}),S?(0,a.jsxs)("span",{className:"absolute left-0 -top-1 text-sm bg-green-500 text-green-50 border border-green-600 rounded-full px-2 py-1",children:["Please"," ",(0,a.jsx)("a",{href:"https://twitter.com/exp_nit",target:"_blank",className:"font-medium underline",children:"contact us"})," ","on twitter to change your email"]}):""]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Z,{children:"Headline"}),(0,a.jsx)(c.Z,{value:A,onChange:e=>{E(e.target.value)},className:"w-full mt-2"}),(0,a.jsx)(f.Z,{children:W})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Z,{children:"Website URL"}),(0,a.jsx)(c.Z,{value:y,onChange:e=>{Z(e.target.value)},className:"w-full mt-2"}),(0,a.jsx)(f.Z,{children:D})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Z,{children:"About"}),(0,a.jsx)(o.Z,{value:C,onChange:e=>{U(e.target.value)},className:"w-full h-28 mt-2"}),(0,a.jsx)(f.Z,{className:"mt",children:M})]}),(0,a.jsx)(l.Z,{isLoad:g,className:"flex justify-center w-full ring-offset-2 ring-orange-500 focus:ring-2 hover:bg-orange-400",children:g?"Updating":"save"})]})})]})]})}},61211:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u},useSupabase:function(){return c}});var a=s(57437),r=s(2265),l=s(65928);let n=(0,r.createContext)();function u(e){let{children:t,session:s,user:u}=e,[c]=(0,r.useState)(()=>(0,l.A)());return(0,a.jsx)(n.Provider,{value:{supabase:c,session:s,user:u},children:(0,a.jsx)(a.Fragment,{children:t})})}let c=()=>(0,r.useContext)(n)},7765:function(e,t,s){"use strict";var a=s(57437),r=s(57999);t.Z=e=>{let{src:t,className:s,...l}=e;return(0,a.jsx)("img",{...l,src:t,loading:"lazy",className:(0,r.Z)("w-10 h-10 rounded-full object-cover ".concat(s))})}},26930:function(e,t,s){"use strict";var a=s(57437),r=s(54796),l=s(57999);t.Z=e=>{let{children:t,child:s,className:n="",variant:u="default",isLoad:c=!1,...i}=e;return(0,a.jsxs)("button",{...i,className:(0,l.Z)("".concat({shiny:"py-2.5 px-3 font-medium text-center text-black active:shadow-none rounded-lg shadow bg-orange-500 hover:bg-orange-600 text-white duration-150",default:"py-2.5 px-3 rounded-lg duration-150 font-medium text-center text-sm text-black bg-orange-500"}[u]," ").concat(c?"flex items-center justify-center pointer-events-none opacity-70":""," ").concat(n)),children:[c?(0,a.jsx)(r.yM,{}):"",!c&&s?(0,a.jsx)("div",{className:"-ml-1 mr-3",children:s}):"",t]})}},51478:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(57437),r=s(57999),l=e=>{let{className:t,required:s,validate:l,...n}=e;return(0,a.jsx)("input",{...n,...l,className:(0,r.Z)("px-3 py-2 bg-white hover:bg-gray-800/40 focus:bg-gray-800/40 text-sm text-black placeholder-slate-500 outline-none focus:border-slate-600 shadow-sm rounded-lg duration-200 ".concat(t))})}},59789:function(e,t,s){"use strict";var a=s(57437),r=s(57999);t.Z=e=>{let{className:t,children:s}=e;return(0,a.jsx)("span",{className:(0,r.Z)("text-sm font-medium text-red-500 block ".concat(t)),children:s})}},20257:function(e,t,s){"use strict";var a=s(57437),r=s(57999);t.Z=e=>{let{children:t,className:s,...l}=e;return(0,a.jsx)("label",{...l,className:(0,r.Z)("text-sm text-black font-medium ".concat(s)),children:t})}},94562:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(57437),r=s(57999),l=e=>{let{className:t,validate:s,...l}=e;return(0,a.jsx)("textarea",{...l,...s,className:(0,r.Z)("px-3 py-2 bg-slate-800/70 hover:bg-slate-800/40 focus:bg-slate-800/40 text-sm text-black placeholder-slate-500 outline-none border border-slate-800 focus:border-slate-600 shadow-sm rounded-lg duration-200 ".concat(t))})}},73550:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});class a{constructor(e){this.supabase=e}}},11639:function(e,t,s){"use strict";s.d(t,{F:function(){return l}});var a=s(31199),r=s.n(a);let l=new class{async get(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,a=this._cache.get(e);if(null!=a)return a;let r=await t();return this._cache.set(e,r,s),r}async del(e){this._cache.del(e)}constructor(){this._cache=new(r())({stdTTL:30})}}},84488:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(73550),r=s(11639);class l extends a.Z{async getById(e){let t="users-".concat(e);return r.F.get(t,async()=>{let{data:t}=await this.supabase.from("profiles").select().eq("id",e).single();return t},180)}async getByUsername(e){let t="users-username-".concat(e);return r.F.get(t,async()=>{let{data:t,error:s}=await this.supabase.from("profiles").select().eq("username",e).single();return t},180)}async getProfiles(){let{data:e,error:t}=await this.supabase.from("profiles").select();return e}async getUserActivityById(e){let{data:t,error:s}=await this.supabase.from("comment").select("*, profiles(full_name, avatar_url), products(name, slug, slogan, logo_url, votes_count, deleted, demo_url)").eq("user_id",e);if(null!==s)throw Error(s.message);return(t||[]).filter(e=>!e.products.deleted)}async getUserVoteTools(e){let{data:t,error:s}=await this.supabase.from("product_votes_view").select("\n        *,\n        product_pricing_types (title),\n        product_category_product (\n          product_categories (\n            name\n          )\n        )\n        ").eq("user_id",e);if(null!==s)throw Error(s.message);return t}async update(e,t){let{data:s,error:a}=await this.supabase.from("profiles").update(t).eq("id",e).select().single();if(null!=a)throw Error(a.message);return s}async updateAvatar(e,t){let{data:s,error:a}=await this.supabase.storage.from("avatars").upload("".concat(e,"/picture"),t,{cacheControl:"0",upsert:!0});if(null!=a)throw Error(a.message);return await this.update(e,{avatar_url:this.supabase.storage.from("avatars").getPublicUrl("".concat(e,"/picture")).data.publicUrl}),s.path}}}},function(e){e.O(0,[171,199,63,971,864,744],function(){return e(e.s=8382)}),_N_E=e.O()}]);