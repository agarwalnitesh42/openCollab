"use strict";exports.id=8841,exports.ids=[8841],exports.modules={60302:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(14001);let s=()=>(0,a.createClientComponentClient)({supabaseUrl:"https://saabvxfsdpnrfhchurch.supabase.co",supabaseKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNhYWJ2eGZzZHBucmZoY2h1cmNoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDEzMTEyNjUsImV4cCI6MjAxNjg4NzI2NX0.aiIds7qBmZlH1yb_X9b1CqqEU0Znto_R0Ur29xyVK90",isSingleton:!0})},31898:(e,t,r)=>{r.d(t,{F:()=>i});var a=r(24580),s=r.n(a);let i=new class{async get(e,t,r=30){let a=this._cache.get(e);if(null!=a)return a;let s=await t();return this._cache.set(e,s,r),s}async del(e){this._cache.del(e)}constructor(){this._cache=new(s())({stdTTL:30})}}},13198:(e,t,r)=>{r.d(t,{Z:()=>i});class a{constructor(e){this.supabase=e}}var s=r(31898);class i extends a{async getWeekNumber(e,t){let r=`week-number-${e}-${t}`;return s.F.get(r,async()=>{let{data:r,error:a}=await this.supabase.rpc("get_week_number",{date_in:e,start_day:t});if(null!==a)throw Error(a.message);return r})}async getWeeks(e,t){let{data:r,error:a}=await this.supabase.rpc("get_weeks",{year_in:e,start_day:t});if(null!==a)throw Error(a.message);return r.map(e=>({week:e.week_number,startDate:e.start_date,endDate:e.end_date}))}async getPrevLaunchDays(e,t=1){let{data:r,error:a}=await this.supabase.rpc("get_prev_launch_days",{_launch_date:e.toISOString(),_limit:t});if(null!==a)throw Error(a.message);return r.map(e=>({launchDate:new Date(e.launch_date),products:(e.products||[]).map(e=>({...e.product,product_pricing_types:e.product_pricing_types,product_categories:e.product_categories}))}))}async getNextLaunchDays(e,t=1){let{data:r,error:a}=await this.supabase.rpc("get_next_launch_days",{_launch_date:e.toISOString(),_limit:t});if(null!==a)throw Error(a.message);return r.map(e=>({launchDate:new Date(e.launch_date),products:(e.products||[]).map(e=>({...e.product,product_pricing_types:e.product_pricing_types,product_categories:e.product_categories}))}))}async getWeeklyWinners(e=0){let{data:t,error:r}=await this.supabase.from("weekly_winners").select();if(null!==r)throw Error(r.message);return t.filter(t=>t.week!==e).map(e=>({...e.product_data.product,product_pricing_types:e.product_data.product_pricing_types,product_categories:e.product_data.product_categories}))}async getPrevLaunchWeeks(e,t,r,a=1){let{data:s,error:i}=await this.supabase.rpc("get_prev_launch_weeks",{_year:e,_start_day:t,_launch_week:r,_limit:a});if(null!==i)throw Error(i.message);return s.map(e=>({week:e.week,startDate:new Date(e.start_date),endDate:new Date(e.end_date),products:(e.products||[]).map(e=>({...e.product,product_pricing_types:e.product_pricing_types,product_categories:e.product_categories}))}))}async getNextLaunchWeeks(e,t,r,a=1){let{data:s,error:i}=await this.supabase.rpc("get_next_launch_weeks",{_year:e,_start_day:t,_launch_week:r,_limit:a});if(null!==i)throw Error(i.message);return s.map(e=>({week:e.week,startDate:new Date(e.start_date),endDate:new Date(e.end_date),products:(e.products||[]).map(e=>({...e.product,product_pricing_types:e.product_pricing_types,product_categories:e.product_categories}))}))}async getProductsCountByDay(e,t){let{data:r,error:a}=await this.supabase.rpc("get_products_count_by_date",{_start_date:e.toISOString(),_end_date:t.toISOString()});if(null!==a)throw Error(a.message);return r.map(e=>({date:new Date(e.date),count:e.product_count}))}async getProductsCountByWeek(e,t,r){let a=async(e,t,r)=>{let{data:a,error:s}=await this.supabase.rpc("get_products_count_by_week",{start_week:e,end_week:t,year_in:r,start_day:2});if(null!==s)throw Error(s.message);return a.map(e=>({week:e.week_number,startDate:new Date(e.start_date),endDate:new Date(e.end_date),count:e.product_count}))},s=[];if(t<=52)s=await a(e,t,r);else{let i=await a(e,52,r),c=await a(1,t-52,r+1);s=[...i,...c]}return s}getProducts(e="votes_count",t=!1,r=20,a=1,i,c=this.EXTENDED_PRODUCT_SELECT){let o=`products-${e}-${t}-${i}-${a}-${r}-${c}`;return s.F.get(o,async()=>{let s=this.supabase.from("products").select(c).eq("deleted",!1);return i&&(s=s.eq("product_categories.id",i)),s.range(r*(a-1),r*a-1).order(e,{ascending:t})})}async getSimilarProducts(e){let{data:t,error:r}=await this.supabase.rpc("get_similar_products",{_product_id:e});if(null!==r)throw Error(r.message);return t}async getTopProducts(e,t){let{data:r,error:a}=await this.getProducts(e,t);if(a)throw Error(a.message);return r}async getMostDiscussedProducts(e=10){let{data:t,error:r}=await this.supabase.from("products").select(this.EXTENDED_PRODUCT_SELECT).eq("deleted",!1).order("comments_count",{ascending:!1}).limit(e);if(null!==r)throw Error(r.message);return t}async getRelatedProducts(e,t,r,a){let{data:s,error:i}=await this.getProducts(r,a).neq("id",e);if(i)return console.error(i),[];let c=s.filter(e=>e.product_categories?.some(e=>t.includes(e.name))).slice(0,8);return c}async getUserProductsById(e){let{data:t}=await this.supabase.from("products").select(this.DEFULT_PRODUCT_SELECT).eq("owner_id",e).eq("deleted",!1);return t}async getUserVoteById(e,t){if(!e||!t)return 0;let{data:r}=await this.supabase.from("product_votes").select().eq("user_id",e).eq("product_id",t).maybeSingle();return r}async getRandomTools(e){let{data:t}=await this.supabase.from("products").select(this.EXTENDED_PRODUCT_SELECT).eq("deleted",!1).limit(e);return t}async getToolsByNameOrDescription(e,t){let r=`product-search-by-text-${e}-${t}`;return s.F.get(r,async()=>{let r=`%${e}%`,{data:a}=await this.supabase.from("products").select(this.EXTENDED_PRODUCT_SELECT).eq("deleted",!1).or(`description.ilike.${r},slogan.ilike.${r},name.ilike.${r}`).limit(t).order("votes_count",{ascending:!1});return a})}async getById(e){let t=`product-details-id-${e}`;return s.F.get(t,async()=>this._getOne("id",e))}async getBySlug(e,t=!1){let r=`product-details-slug-${e}`,a=await s.F.get(r,async()=>{let{data:t}=await this.supabase.from("products").select(this.DEFULT_PRODUCT_SELECT).eq("slug",e).single();return t});return t&&a&&!a.deleted&&this.viewed(a.id),a}async toggleVote(e,t){let{data:r}=await this.supabase.rpc("toggleProductVote",{_product_id:e,_user_id:t});return r??0}async viewed(e){let{data:t}=await this.supabase.rpc("updateViews",{_product_id:e});return t??0}async insert(e,t){let{data:r,error:a}=await this.supabase.from("products").insert(e).select().single();if(null!==a)throw Error(a.message);return 0!==t.length&&await Promise.all(t.map(async e=>await this._addProductToCategory(r.id,e))),r}async update(e,t,r=[]){var a;let s=(a=["deleted_at","deleted"],Object.fromEntries(Object.entries(t).filter(([e,t])=>!a.includes(e)))),{data:i,error:c}=await this.supabase.from("products").update(s).eq("id",e).select().single();if(await this.supabase.from("product_category_product").delete().eq("product_id",e),await Promise.all(r.map(async t=>await this._addProductToCategory(e,t))),null!=c)throw Error(c.message);return i}async delete(e){let{error:t}=await this.supabase.from("products").update({deleted:!0,deleted_at:new Date().toISOString()}).eq("id",e);if(null!==t)throw Error(t.message)}async search(e){let{data:t,error:r}=await this.supabase.from("products").select("*").ilike("name",`%${e}%`).eq("deleted",!1).limit(8);if(null!==r)throw Error(r.message);return t}async _addProductToCategory(e,t){let{error:r}=await this.supabase.from("product_category_product").insert({product_id:e,category_id:t});if(null!=r)throw Error(r.message);return!0}async _getOne(e,t,r=this.DEFULT_PRODUCT_SELECT){let{data:a}=await this.supabase.from("products").select(r).eq("deleted",!1).eq(e,t).single();return a}constructor(...e){super(...e),this.DEFULT_PRODUCT_SELECT="*, product_pricing_types(*), product_categories(name, id)",this.EXTENDED_PRODUCT_SELECT="*, product_pricing_types(*), product_categories(*), profiles (full_name)",this.EXTENDED_PRODUCT_SELECT_WITH_CATEGORIES="*, product_pricing_types(*), product_categories!inner(*), profiles (full_name)"}}}};